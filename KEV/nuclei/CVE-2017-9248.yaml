id: CVE-2017-9248

info:
  name: Telerik Web UI MachineKey bruteforce leading to RCE
  author: Mohamed Benchikh
  severity: critical
  description: Telerik.Web.UI.dll in Progress Telerik UI for ASP.NET AJAX before R2 2017 SP1 and Sitefinity before 10.0.6412.0 does not properly protect Telerik.Web.UI.DialogParametersEncryptionKey or the MachineKey, which makes it easier for remote attackers to defeat cryptographic protection mechanisms, leading to a MachineKey leak, arbitrary file uploads or downloads, XSS, or ASP.NET ViewState compromise.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2017-9248
    - https://github.com/bao7uo/dp_crypto
  remediation: Upgrade UI for ASP.NET AJAX to application version 2017.2.621 or later.
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2017-9248
    cwe-id: CWE-522
  tags: telerik,cve-2017-9248

requests:
  - method: GET
    path:
      - '{{BaseURL}}'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        name: version
        words:
          - ';Telerik.Web.UI, Version=2007.1423'
          - ';Telerik.Web.UI, Version=2007.1521'
          - ';Telerik.Web.UI, Version=2007.1626'
          - ';Telerik.Web.UI, Version=2007.2918'
          - ';Telerik.Web.UI, Version=2007.2101'
          - ';Telerik.Web.UI, Version=2007.21107'
          - ';Telerik.Web.UI, Version=2007.31218'
          - ';Telerik.Web.UI, Version=2007.31314'
          - ';Telerik.Web.UI, Version=2007.31425'
          - ';Telerik.Web.UI, Version=2008.1415'
          - ';Telerik.Web.UI, Version=2008.1515'
          - ';Telerik.Web.UI, Version=2008.1619'
          - ';Telerik.Web.UI, Version=2008.2723'
          - ';Telerik.Web.UI, Version=2008.2826'
          - ';Telerik.Web.UI, Version=2008.21101'
          - ';Telerik.Web.UI, Version=2008.31105'
          - ';Telerik.Web.UI, Version=2008.31125'
          - ';Telerik.Web.UI, Version=2008.31314'
          - ';Telerik.Web.UI, Version=2009.1311'
          - ';Telerik.Web.UI, Version=2009.1402'
          - ';Telerik.Web.UI, Version=2009.1527'
          - ';Telerik.Web.UI, Version=2009.2701'
          - ';Telerik.Web.UI, Version=2009.2826'
          - ';Telerik.Web.UI, Version=2009.31103'
          - ';Telerik.Web.UI, Version=2009.31208'
          - ';Telerik.Web.UI, Version=2009.31314'
          - ';Telerik.Web.UI, Version=2010.1309'
          - ';Telerik.Web.UI, Version=2010.1415'
          - ';Telerik.Web.UI, Version=2010.1519'
          - ';Telerik.Web.UI, Version=2010.2713'
          - ';Telerik.Web.UI, Version=2010.2826'
          - ';Telerik.Web.UI, Version=2010.2929'
          - ';Telerik.Web.UI, Version=2010.31109'
          - ';Telerik.Web.UI, Version=2010.31215'
          - ';Telerik.Web.UI, Version=2010.31317'
          - ';Telerik.Web.UI, Version=2011.1315'
          - ';Telerik.Web.UI, Version=2011.1413'
          - ';Telerik.Web.UI, Version=2011.1519'
          - ';Telerik.Web.UI, Version=2011.2712'
          - ';Telerik.Web.UI, Version=2011.2915'
          - ';Telerik.Web.UI, Version=2011.31115'
          - ';Telerik.Web.UI, Version=2011.3.1305'
          - ';Telerik.Web.UI, Version=2012.1.215'
          - ';Telerik.Web.UI, Version=2012.1.411'
          - ';Telerik.Web.UI, Version=2012.2.607'
          - ';Telerik.Web.UI, Version=2012.2.724'
          - ';Telerik.Web.UI, Version=2012.2.912'
          - ';Telerik.Web.UI, Version=2012.3.1016'
          - ';Telerik.Web.UI, Version=2012.3.1205'
          - ';Telerik.Web.UI, Version=2012.3.1308'
          - ';Telerik.Web.UI, Version=2013.1.220'
          - ';Telerik.Web.UI, Version=2013.1.403'
          - ';Telerik.Web.UI, Version=2013.1.417'
          - ';Telerik.Web.UI, Version=2013.2.611'
          - ';Telerik.Web.UI, Version=2013.2.717'
          - ';Telerik.Web.UI, Version=2013.3.1015'
          - ';Telerik.Web.UI, Version=2013.3.1114'
          - ';Telerik.Web.UI, Version=2013.3.1324'
          - ';Telerik.Web.UI, Version=2014.1.225'
          - ';Telerik.Web.UI, Version=2014.1.403'
          - ';Telerik.Web.UI, Version=2014.2.618'
          - ';Telerik.Web.UI, Version=2014.2.724'
          - ';Telerik.Web.UI, Version=2014.3.1024'
          - ';Telerik.Web.UI, Version=2015.1.204'
          - ';Telerik.Web.UI, Version=2015.1.225'
          - ';Telerik.Web.UI, Version=2015.1.401'
          - ';Telerik.Web.UI, Version=2015.2.604'
          - ';Telerik.Web.UI, Version=2015.2.623'
          - ';Telerik.Web.UI, Version=2015.2.729'
          - ';Telerik.Web.UI, Version=2015.2.826'
          - ';Telerik.Web.UI, Version=2015.3.930'
          - ';Telerik.Web.UI, Version=2015.3.1111'
          - ';Telerik.Web.UI, Version=2016.1.113'
          - ';Telerik.Web.UI, Version=2016.1.225'
          - ';Telerik.Web.UI, Version=2016.2.504'
          - ';Telerik.Web.UI, Version=2016.2.607'
          - ';Telerik.Web.UI, Version=2016.3.914'
          - ';Telerik.Web.UI, Version=2016.3.1018'
          - ';Telerik.Web.UI, Version=2016.3.1027'
          - ';Telerik.Web.UI, Version=2017.1.118'
          - ';Telerik.Web.UI, Version=2017.1.228'
          - ';Telerik.Web.UI, Version=2017.2.503'
          - ';Telerik.Web.UI, Version=2017.2.621'
          - ';Telerik.Web.UI, Version=2017.2.711'
          - ';Telerik.Web.UI, Version=2017.3.913'
        condition: or


      
